(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{119:function(e,t,n){e.exports=n.p+"static/media/viikkis.86ac6c38.png"},131:function(e,t,n){e.exports=n(276)},200:function(e,t,n){},204:function(e,t,n){},267:function(e,t){},272:function(e,t,n){},274:function(e,t,n){},276:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"types",function(){return L}),n.d(a,"setState",function(){return S}),n.d(a,"getArticles",function(){return A}),n.d(a,"getWeekArticles",function(){return N}),n.d(a,"getArticle",function(){return _}),n.d(a,"getSummary",function(){return M}),n.d(a,"deleteArticle",function(){return R}),n.d(a,"updateArticle",function(){return D}),n.d(a,"createWeek",function(){return G}),n.d(a,"login",function(){return W}),n.d(a,"logout",function(){return U});var i={};n.r(i),n.d(i,"types",function(){return V}),n.d(i,"setConfigState",function(){return K}),n.d(i,"navigate",function(){return H}),n.d(i,"navigateHome",function(){return P}),n.d(i,"setNextWeek",function(){return z}),n.d(i,"setPrevWeek",function(){return B});n(132);var r=n(1),o=n.n(r),s=n(23),c=n.n(s),l=n(8),u=n(9),p=n(12),d=n(10),f=n(11),m=n(16),h=n(280),E=n(7),k=n(25),v=n.n(k),g=n(43),y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};return e.map(function(e){return t[e]={NAME:e,PENDING:"".concat(e,"_PENDING"),FULFILLED:"".concat(e,"_FULFILLED"),REJECTED:"".concat(e,"_REJECTED")}}),t},b="http://viikkis.indecs.fi/api.php",w=[{fi:"Yleist\xe4",en:"General"},{fi:"Indecsin tapahtumat",en:"Indecs events"},{fi:"TREY tiedottaa",en:"Student Union announces"},{fi:"Tampereen Teekkarit tiedottaa",en:"Teekkari Union of Tampere announces"},{fi:"Yritystiimi tiedottaa",en:"Corporate Relations Team announces"},{fi:"Tulevat tapahtumat",en:"Upcoming events"},{fi:"ESTIEM asiaa",en:"ESTIEM affairs"},{fi:"Loppukevennys",en:""}],T="SUMMARY",O="ARTICLE",C="\notsikon_ylle: Tuotantotalouden kilta Indecs\notsikon_alle: Viikko 1\nsposti_aihe: Indecsin Viikkotiedote 1 \u2014 Indecs' Newsletter 1\nurl: http://www.google.fi\nnimi: Leevi T\xf6rnblom\ntitteli: Sihteeri / Secretary\nkilta: Tuotantotalouden kilta Indecs Ry\nguild: Guild of Industrial Engineering and Management Indecs\nyliopisto: Tampereen teknillinen yliopisto\nuniversity: Tampere University of Technology\npuhelin: 0408431989\nsposti: sihteeri@indecs.fi\ninternet: www.indecs.fi\n\n",x="\n\n# Sis\xe4llysluettelo - Table of Contents\n\n[TOC]\n\n",I=n(20),j=n.n(I),L=y(["SET_STATE","GET_ARTICLES","UPDATE_ARTICLE","CREATE_WEEK","GET_ARTICLE","DELETE_ARTICLE","GET_SUMMARY","LOGIN","LOGOUT","GET_TEXT","GET_WEEK_ARTICLES"]),S=function(e){return{type:L.SET_STATE.NAME,payload:e}},A=function(){return{type:L.GET_ARTICLES.NAME,payload:j.a.get("".concat(b,"/articles"))}},N=function(e){var t=e.year,n=e.week;return{type:L.GET_WEEK_ARTICLES.NAME,payload:j.a.get("".concat(b,"/articles?year=").concat(t,"&week=").concat(n))}},_=function(e){return{type:L.GET_ARTICLE.NAME,payload:j.a.get("".concat(b,"/articles/").concat(e))}},M=function(e){var t=e.year,n=e.week;return{type:L.GET_SUMMARY.NAME,payload:j.a.get("".concat(b,"/articles?year=").concat(t,"&week=").concat(n))}},R=function(e){return{type:L.DELETE_ARTICLE.NAME,payload:j.a.delete("".concat(b,"/articles/").concat(e))}},D=function(e){var t=e.id,n=e.text;return{type:L.UPDATE_ARTICLE.NAME,payload:j.a.put("".concat(b,"/articles/").concat(t),JSON.stringify({text:n}))}},G=function(e){return{type:L.CREATE_WEEK.NAME,payload:j.a.all(e.map(function(){var e=Object(g.a)(v.a.mark(function e(t){var n;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("".concat(b,"/articles"),JSON.stringify(t));case 2:return n=e.sent,e.abrupt("return",Object(E.a)({},t,{id:n.data,edited_at:"0000-00-00 00:00:00",created_at:(new Date).toISOString()}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()))}},W=function(e){var t=e.email,n=e.password;return{type:L.LOGIN.NAME,payload:function(){var e=Object(g.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("hallitus@indecs.fi"!==t||"L3d1v4l0"!==n){e.next=4;break}return e.abrupt("return",{email:t,password:n});case 4:throw new Error("wrong password");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}},U=function(){return{type:L.LOGOUT.NAME}},Y=n(15),F=n.n(Y),V=y(["SET_CONFIG_STATE","NAVIGATE","NAVIGATE_HOME"]),K=function(e){return{type:V.SET_CONFIG_STATE.NAME,payload:e}},H=function(e){return{type:V.NAVIGATE.NAME,payload:e}},P=function(){return function(e){e({type:V.NAVIGATE_HOME.NAME})}},z=function(){return function(e,t){var n=F()(t().config.now).add(1,"weeks"),a=parseInt(n.format("WW")),i=parseInt(n.format("YYYY"));return e(K({now:n,week:a,year:i})),e(N({week:a,year:i}))}},B=function(){return function(e,t){var n=F()(t().config.now).subtract(1,"weeks"),a=parseInt(n.format("WW")),i=parseInt(n.format("YYYY"));return e(K({now:n,week:a,year:i})),e(N({week:a,year:i}))}},J=n(19),$=n(55),X=Object($.b)(function(e,t){return e},function(e){return Object(J.b)(Object(E.a)({},a,i),e)}),q=n(119),Z=n.n(q),Q=n(292),ee=n(277),te=n(278),ne=n(279),ae=X(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={dropdownOpen:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"logout",value:function(){localStorage.removeItem("email"),localStorage.removeItem("password"),this.props.logout()}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("div",{style:ie.top},o.a.createElement("div",{style:ie.left},o.a.createElement("img",{src:Z.a,alt:"Viikkis Indecs",style:{height:60}})),this.props.app.logged&&o.a.createElement("div",{style:ie.right},o.a.createElement(Q.a,{isOpen:this.state.dropdownOpen,toggle:function(){return e.setState({dropdownOpen:!e.state.dropdownOpen})},direction:"left"},o.a.createElement(ee.a,null,o.a.createElement("i",{className:"fa fa-bars",style:{fontSize:30,color:"white"}})),o.a.createElement(te.a,null,o.a.createElement(ne.a,{header:!0},this.props.app.user.email),o.a.createElement(ne.a,{divider:!0}),o.a.createElement(ne.a,{disabled:!0},o.a.createElement("i",{className:"fa fa-users",style:{marginRight:5}})," ",this.props.app.sockets.length," paikalla"),o.a.createElement(ne.a,{divider:!0}),o.a.createElement(ne.a,{disabled:!0},o.a.createElement("i",{className:"fa fa-cog",style:{marginRight:5}})," Asetukset"),o.a.createElement(ne.a,{divider:!0}),o.a.createElement(ne.a,{onClick:function(){return e.logout()}},o.a.createElement("i",{className:"fa fa-sign-out-alt",style:{marginRight:5}}),"Kirjaudu ulos"))))))}}]),t}(r.Component)),ie={top:{backgroundColor:"rgba(0,0,0,0.5)",height:60,width:"100%",display:"flex",flexDirection:"row",flex:1,color:"white",justifyContent:"space-between"},left:{display:"flex",alignItems:"center",cursor:"pointer"},users:{position:"absolute",top:5,right:5,fontSize:15,color:"white"},right:{display:"flex",alignItems:"center",justifyContent:"flex-end",paddingRight:10,cursor:"pointer"}},re=n(281),oe=n(282),se=n(283),ce=n(284),le=n(285),ue=n(199),pe=X(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={email:"",password:"",rememberMe:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"login",value:function(){var e=this;this.props.login({password:this.state.password,email:this.state.email}).then(function(){e.state.rememberMe&&(localStorage.setItem("email",e.state.email),localStorage.setItem("password",e.state.password))}).catch(function(){return m.toast.error("V\xe4\xe4r\xe4 k\xe4ytt\xe4j\xe4tunnus tai salasana")})}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:de.wrapper},o.a.createElement(h.a,{style:de.container},o.a.createElement("h2",null,"Kirjaudu sis\xe4\xe4n"),o.a.createElement(re.a,{className:"form"},o.a.createElement(oe.a,null,o.a.createElement(se.a,null,o.a.createElement(ce.a,null,"S\xe4hk\xf6posti"),o.a.createElement(le.a,{type:"email",name:"email",id:"exampleEmail",placeholder:"sposti@sposti.com",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}}))),o.a.createElement(oe.a,null,o.a.createElement(se.a,null,o.a.createElement(ce.a,{for:"examplePassword"},"Salasana"),o.a.createElement(le.a,{type:"password",name:"password",id:"examplePassword",placeholder:"********",onChange:function(t){return e.setState({password:t.target.value})},value:this.state.password}))),o.a.createElement(oe.a,null,o.a.createElement(se.a,{check:!0},o.a.createElement(ce.a,{check:!0},o.a.createElement(le.a,{id:"rememberMe",type:"checkbox",value:this.state.rememberMe,onChange:function(t){return e.setState({rememberMe:t.target.value})}})," "," Muista minut"))),o.a.createElement(ue.a,{onClick:function(){return e.login()}},"Kirjaudu sis\xe4\xe4n"))))}}]),t}(r.Component)),de={container:{boxShadow:"#999 0 0 12px",borderRadius:"4px",backgroundColor:"white",padding:20,margin:10},wrapper:{flex:1,display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,bottom:0,right:0}},fe=n(29),me=(n(200),n(3)),he=n.n(me);function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=e.value;if(e.selectionStart||0===e.selectionStart){var r=e.selectionStart,o=e.selectionEnd,s=e.scrollTop;r===o?(e.value=i.substring(0,r)+t+n+a+i.substring(o,i.length),e.selectionStart=r+t.length,e.selectionEnd=o+t.length+n.length):(e.value=i.substring(0,r)+t+i.substring(r,o)+a+i.substring(o,i.length),e.selectionStart=r+t.length,e.selectionEnd=o+t.length),e.focus(),s>=0&&(e.scrollTop=s)}}var ke={h1:function(e){Ee(e,"# ","Iso otsikko")},h2:function(e){Ee(e,"## ","Keskikokoinen otsikko")},h3:function(e){Ee(e,"### ","Pieni otsikko")},bold:function(e){Ee(e,"**","Lihavoitu teksti","**")},italic:function(e){Ee(e,"*","Kursivoitu teksti","*")},image:function(e){Ee(e,"![Kuvan vaihtoehtoinen teksti jos kuva ei toimi](","https://indecs.fi/indecs-fi/wp-content/uploads/2019/01/Indecs_logo_teksti.png",")")},link:function(e){Ee(e,"[FB-tapahtuma](","http://www.facebook.com",")")},linkButton:function(e){Ee(e,"?[FB-tapahtuma](","http://www.facebook.com",")")},code:function(e){Ee(e,"```\n","Lainaus","\n```")},list:function(e){Ee(e,"Lista 1  \nLista 2  \n","Lista 3","  ")},listUl:function(e){Ee(e,"- Lista 1\n- Lista 2\n- ","Lista 3")},listOl:function(e){Ee(e,"1. Lista 1\n2. Lista 2\n","3. Lista 3")},table:function(e){Ee(e,"| Otsikko 1 | Otsikko 2 | Otsikko 3 |\n | - | - | - | \n| ","t\xe4h\xe4n"," | tulee | sis\xe4lt\xf6 |\n| toisen | rivin | sis\xe4lt\xf6 |")},tab:function(e){Ee(e,"  ")}},ve=function(e,t){return ke[t](e)},ge=66,ye=73,be=83,we=90,Te=89,Oe=9,Ce=(n(202),n(204),n(129)),xe=n(44),Ie=n.n(xe),je=n(206);je.registerLanguage("css",n(207)),je.registerLanguage("json",n(208)),je.registerLanguage("less",n(209)),je.registerLanguage("scss",n(210)),je.registerLanguage("javascript",n(211)),je.registerLanguage("typescript",n(212));var Le=je;Ie.a.setOptions({renderer:new Ie.a.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,highlight:function(e){return Le.highlightAuto(e).value}});var Se=new Ie.a.Renderer;Se.paragraph=function(e){return"<p>".concat(e,"</p>")},Se.link=function(e,t,n){return"<a href=".concat(e,"\n      title=").concat(t||e,"\n      target='_blank'\n      }>").concat(n,"</a>")};var Ae=function(e,t){return t?"".concat(e," - ").concat(t):"".concat(e)},Ne=function(e,t,n){return"string"!=typeof(a=t+function(e,t){var n=e,a=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var c=o.value,l=Object(Ce.a)(c,2),u=l[0],p=l[1];n=n.replace(u,p)}}catch(d){i=!0,r=d}finally{try{a||null==s.return||s.return()}finally{if(i)throw r}}return n}(e,[[/^###(.*)/gm,"<h3>$1</h3>"],[/^##(.*)/gm,"<h2>$1</h2>"],[/^#(.*)/gm,"<h1>$1</h1>"],[/\?\[(.+?)\]\((.*\))/g,'<button class="customButton" href="$2">$1</button>']])+n)?"":Ie()(a,{renderer:Se});var a},_e=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){var t=e.target.value;n.saveHistory(t),n.props.onChange(t)},n.insert=function(e){var t=Object(fe.a)(Object(fe.a)(n)).$vm,a=e.currentTarget?e.currentTarget.getAttribute("data-type"):e;ve(t,a),n.props.onChange(t.value),n.saveHistory(t.value)},n.undo=function(){var e=n.state.f_history,t=n.state.f_history_index;if(!((t-=1)<0)){n.setState({f_history_index:t});var a=e[t];n.props.onChange(a),n.handleLineIndex(a)}},n.redo=function(){var e=n.state.f_history,t=n.state.f_history_index;if(!((t+=1)>=e.length)){n.setState({f_history_index:t});var a=e[t];n.props.onChange(a),n.handleLineIndex(a)}},n.preview=function(){n.setState({preview:!n.state.preview})},n.expand=function(){n.setState({expand:!n.state.expand})},n.save=function(){n.props.onSave()},n.$vm=null,n.handleEditorRef=function(e){n.$vm=e},n.state={preview:!(window.innerWidth<700),expand:!1,f_history:[],f_history_index:0,line_index:1,height:600,width:1e3},n.updateWindowDimensions=n.updateWindowDimensions.bind(Object(fe.a)(Object(fe.a)(n))),n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e;(e=this).$vm.addEventListener("keydown",function(t){if(t.ctrlKey||t.metaKey||t.altKey||t.shiftKey){if((t.ctrlKey||t.metaKey)&&!t.altKey&&!t.shiftKey)switch(t.keyCode){case we:t.preventDefault(),e.undo();break;case Te:t.preventDefault(),e.redo();break;case be:t.preventDefault(),e.save();break;case ge:t.preventDefault(),e.insert("bold");break;case ye:t.preventDefault(),e.insert("italic")}}else switch(t.keyCode){case Oe:t.preventDefault(),e.insert("tab")}}),this.updateWindowDimensions(),window.addEventListener("resize",this.updateWindowDimensions)}},{key:"componentWillUpdate",value:function(e,t){var n=this.state.f_history;e.value&&0===t.f_history.length&&(n.push(e.value),this.setState({f_history:n}),this.handleLineIndex(e.value))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateWindowDimensions)}},{key:"updateWindowDimensions",value:function(){this.setState({width:window.innerWidth,height:window.innerHeight})}},{key:"saveHistory",value:function(e){var t=this,n=this.state,a=n.f_history,i=n.f_history_index;window.clearTimeout(this.currentTimeout),this.currentTimeout=setTimeout(function(){i<a.length-1&&a.splice(i+1),a.length>=20&&a.shift(),i=a.length,a.push(e),t.setState({f_history:a,f_history_index:i})},500),this.handleLineIndex(e)}},{key:"handleLineIndex",value:function(e){var t=e?e.split("\n").length:1;this.setState({line_index:t})}},{key:"isMobile",value:function(){return this.state.width<700}},{key:"render",value:function(){var e=this.state,t=e.preview,n=e.expand,a=e.line_index,i=this.props.value,r=he()({"for-panel":!0,"for-preview-hidden":!t}),s=he()({"for-panel":!0,"for-editor-hidden":!!this.isMobile()&&t}),c=he()({"for-active":t}),l=he()({"for-container":!0,"for-fullscreen":n}),u=he()({"for-active":n}),p=he()({"for-line-num":!0,hidden:!this.props.lineNum});return o.a.createElement("div",{className:l,style:{height:this.state.expand?this.state.height:this.state.height-100}},o.a.createElement("div",{className:"for-controlbar",style:{display:this.isMobile()?"block":"flex"}},o.a.createElement("ul",null,o.a.createElement("li",{"data-type":"h1",onClick:this.insert,title:"Iso otsikko"},"H1"),o.a.createElement("li",{"data-type":"h2",onClick:this.insert,title:"Keskikokoinen otsikko"},"H2"),o.a.createElement("li",{"data-type":"h3",onClick:this.insert,title:"Pieni otsikko"},"H3"),o.a.createElement("li",{"data-type":"bold",onClick:this.insert,title:"Lihavoitu teksti (ctrl+b)"},o.a.createElement("i",{className:"fa fa-bold"})),o.a.createElement("li",{"data-type":"italic",onClick:this.insert,title:"Kursivoitu teksti (ctrl+i)"},o.a.createElement("i",{className:"fa fa-italic"})),o.a.createElement("li",{"data-type":"image",onClick:this.insert,title:"Kuva"},o.a.createElement("i",{className:"foricon for-image"})),o.a.createElement("li",{"data-type":"link",onClick:this.insert,title:"Linkki"},o.a.createElement("i",{className:"foricon for-link"})),o.a.createElement("li",{"data-type":"linkButton",onClick:this.insert,title:"Linkki painike"},o.a.createElement("i",{className:"fab fa-facebook-square"})),o.a.createElement("li",{"data-type":"table",onClick:this.insert,title:"Taulukko"},o.a.createElement("i",{className:"fa fa-table"}))),o.a.createElement("ul",null,o.a.createElement("li",{"data-type":"list",onClick:this.insert,title:"Lista"},o.a.createElement("i",{className:"fa fa-list"})),o.a.createElement("li",{"data-type":"listUl",onClick:this.insert,title:"T\xe4pl\xe4 lista"},o.a.createElement("i",{className:"fa fa-list-ul"})),o.a.createElement("li",{"data-type":"listOl",onClick:this.insert,title:"Numeroitu lista"},o.a.createElement("i",{className:"fa fa-list-ol"})),o.a.createElement("li",{"data-type":"code",onClick:this.save,title:"Tallenna (ctrl+s)"},o.a.createElement("i",{className:"foricon for-save"})),o.a.createElement("li",{className:u,onClick:this.expand},u?o.a.createElement("i",{className:"foricon for-contract"}):o.a.createElement("i",{className:"foricon for-expand"})),o.a.createElement("li",{className:c,onClick:this.preview},c?o.a.createElement("i",{className:"foricon for-eye-off"}):o.a.createElement("i",{className:"foricon for-eye"})),o.a.createElement("li",{onClick:this.undo,title:"Taaksep\xe4in (ctrl+z)"},o.a.createElement("i",{className:"foricon for-undo"})),o.a.createElement("li",{onClick:this.redo,title:"Eteenp\xe4in (ctrl+y)"},o.a.createElement("i",{className:"foricon for-redo"})))),o.a.createElement("div",{className:"for-editor"},o.a.createElement("div",{className:s},o.a.createElement("div",{className:"for-editor-wrapper"},o.a.createElement("div",{className:"for-editor-block"},function(){for(var e=[],t=0;t<a;t++)e.push(o.a.createElement("li",{key:t+1},t+1));return o.a.createElement("ul",{className:p},e)}(),o.a.createElement("div",{className:"for-editor-content"},o.a.createElement("pre",null,i," "),o.a.createElement("textarea",{ref:this.handleEditorRef,value:i,onChange:this.handleChange,placeholder:this.props.placeholder,spellCheck:"false",autoCapitalize:"off",autoCorrect:"off"}))))),o.a.createElement("div",{className:r},o.a.createElement("div",{className:"for-preview for-markdown-preview",dangerouslySetInnerHTML:{__html:Ne(i,this.props.topValue,this.props.bottomValue)}}))))}}]),t}(o.a.Component);_e.defaultProps={placeholder:"",lineNum:!0,topValue:"",bottomValue:""};var Me=_e,Re=n(291),De=n(121),Ge=n.n(De),We=X(function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){n.state.disconnected?n.reconnect():(n.setState({value:e}),n.props.socket.emit("set text",e))},n.props.getText(function(e){return n.setState({value:e})}),n.props.onDisconnect(function(){n.setState({disconnected:!0})}),n.id=n.props.config.articleId,n.state={value:"",autoSave:!0,previousValue:"",disconnected:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.getArticle(this.id).then(function(t){var n=t.action.payload.data;e.setState({value:n.text,previousValue:n.text}),e.props.socket.emit("join room",n),e.interval=setInterval(function(){e.isEdited()&&(e.setState({previousValue:e.state.value}),e.handleSave())},6e4)}).catch(function(t){e.props.navigate("HOME")})}},{key:"isEdited",value:function(){return this.state.value!==this.state.previousValue}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"reconnect",value:function(){var e=this;this.props.getArticle(this.id).then(function(t){var n=t.action.payload.data;e.setState({value:n.text,previousValue:n.text,disconnected:!1}),e.props.socket.emit("join room",n)}).catch(function(t){e.props.navigate("HOME")})}},{key:"handleSave",value:function(){this.props.updateArticle({id:this.id,text:this.state.value}).then(function(){return m.toast.success("Artikkeli tallennettu")}).catch(function(){return m.toast.error("Virhe tallennettaessa artikkelia")})}},{key:"socketsOnline",value:function(){var e=this.props.app.rooms;return(e[this.id]?e[this.id].sockets:[]).length>1}},{key:"render",value:function(){var e=this,t=this.state.value;return o.a.createElement("div",{style:{height:"100%"}},this.isEdited()&&o.a.createElement(Ge.a,{onBeforeunload:function(){return"Haluatko varmasti poistua? Viimeisempi\xe4 muutoksia ei ole tallennettu."}}),this.socketsOnline()&&o.a.createElement(Re.a,{color:"warning"},"Toinen k\xe4ytt\xe4j\xe4 on muokkaamassa tiedostoa!"),o.a.createElement("div",{style:{boxShadow:"#999 0 0 12px",borderRadius:"4px"}},o.a.createElement(Me,{value:t,onChange:this.handleChange,onSave:function(){return e.handleSave()}})))}}]),t}(r.Component)),Ue=n(286),Ye=n(287),Fe=X(function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.props.config,n=t.year,a=t.week,i=t.articleId,r=t.screen,s="ARTICLE"===r&&this.props.app.articles.find(function(e){return e.id===i}),c=s?"".concat(s.position,". ").concat(Ae(s.title,s.title_en)):"Viikkotiedote";return o.a.createElement(Ue.a,null,o.a.createElement(Ye.a,{onClick:function(){return e.props.navigate("HOME")}},o.a.createElement("a",{href:"javascript:void(0)"},"Viikkis ",a,"/",n)),("ARTICLE"===r||"SUMMARY"===r)&&o.a.createElement(Ye.a,{active:!0}," ",c))}}]),t}(r.Component)),Ve=n(122),Ke=X(function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).year=n.props.config.year,n.week=n.props.config.week,n.state={value:"",config:C,toc:x,showModal:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.getSummary({year:this.year,week:this.week})}},{key:"toggleModal",value:function(){this.setState({showModal:!this.state.showModal})}},{key:"exportHtml",value:function(e){var t=document.createElement("a"),n=new Blob([e],{type:"text/plain"});t.href=URL.createObjectURL(n),t.download="".concat(this.year,"-").concat(this.week,"-viikkis.html"),t.click()}},{key:"exportFile",value:function(){var e=document.createElement("a"),t=(this.state.config+this.state.toc+this.props.app.summary).replace(/\n/g,"\r\n"),n=new Blob([t],{type:"text/plain"});e.href=URL.createObjectURL(n),e.download="".concat(this.year,"-").concat(this.week,"-viikkis.md"),e.click()}},{key:"render",value:function(){var e=this,t=this.props.app.summary,n=function(e){var t=0,n=0,a=0;return e.replace("\n\n","\n").split("\n").map(function(e){return e.trim()}).filter(function(e){return e.length>0}).reduce(function(e,i){return"###"===i.substring(0,3)?(a+=1,e+"    - [".concat(t,".").concat(n,".").concat(a,". ").concat(i.replace("###",""),"](javascript:void(0);)\n")):"##"===i.substring(0,2)?(a=0,n+=1,e+"  - [".concat(t,".").concat(n,". ").concat(i.replace("##",""),"](javascript:void(0);)\n")):"#"===i.substring(0,1)?(a=0,n=0,e+"- [".concat(t+=1,". ").concat(i.replace("#",""),"](javascript:void(0);)\n")):e},[])}(this.props.app.summary),a=function(e,t){return'\n<font class="margin"></font>\n<font class="top-kilta">Tuotantotalouden kilta Indecs</font>\n<font class="top-viikkotiedote">Viikkotiedote</font>\n<font class="top-numero">Numero '.concat(e-1," - Viikko ").concat(e,'</font>\n<font class="margin"></font>\n<font class="top-toc"> Sis\xe4llysluettelo - Table of contents</font>\n').concat(t,"\n")}(this.week,n),i='\n<font class="margin"></font>\n<font class="top-kilta">Terveisin - Regards</font>\n<font class="top-viikkotiedote">Leevi T\xf6rnblom</font>\n<font class="top-numero">Sihteeri / Secretary</font>\n<font class="bottom-default">Tuotantotalouden kilta Indecs ry</font>\n<font class="bottom-default">Guild of Industrial Engineering and Management Indecs</font>\n<font class="bottom-default">Tampereen yliopisto</font>\n<font class="bottom-default">Tampere University</font>\n<font class="bottom-default">0408431989</font>\n<font class="bottom-default">sihteeri@indecs.fi</font>\n<font class="bottom-default">[www.indecs.fi]www.indecs.fi</font>\n<font class="margin"></font>\n';return o.a.createElement(o.a.Fragment,null,o.a.createElement(Ve.a,{open:this.state.showModal,onClose:function(){return e.toggleModal()},center:!0},o.a.createElement("div",{style:{minHeight:300,width:600}},o.a.createElement(re.a,null,o.a.createElement(se.a,null,o.a.createElement(ce.a,{for:"config"},"M\xe4\xe4rit\xe4 sihteerin asetukset"),o.a.createElement(le.a,{type:"textarea",style:{height:200},id:"config",value:this.state.config,onChange:function(t){return e.setState({config:t.target.value})}}),o.a.createElement(ue.a,{color:"success",block:!0,onClick:function(){return e.exportFile()}},"Lataa .md -muodossa"),o.a.createElement(ue.a,{color:"primary",block:!0,onClick:function(){return e.exportHtml(Ne(t,a,i))}},"Lataa .html -muodossa"))))),o.a.createElement(ue.a,{color:"success",block:!0,onClick:function(){return e.toggleModal()}},"Lataa viikkis"),o.a.createElement("div",{style:{boxShadow:"#999 0 0 12px",borderRadius:"4px"}},o.a.createElement(Me,{topValue:a,bottomValue:i,value:t,onChange:function(){},onSave:function(){}})))}}]),t}(r.Component)),He=n(288),Pe=n(289),ze=n(290),Be=n(30),Je=X(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={titles:w},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"createWeek",value:function(){var e=this;if(this.state.titles.find(function(e){return""===e.fi.trim()}))alert("Kaikki suomenkieliset kent\xe4t ovat pakollisia!");else{var t=this.state.titles.map(function(t,n){return{year:e.props.year,week:e.props.week,position:n+1,title:t.fi,title_en:t.en,text:"# ".concat(Ae(t.fi,t.en)," \n\n"),text_en:""}});this.props.createWeek(t)}}},{key:"deleteHeading",value:function(e){this.setState({titles:this.state.titles.reduce(function(t,n,a){return a===e?t:Object(Be.a)(t).concat([n])},[])})}},{key:"render",value:function(){var e=this,t=this.state.titles;return o.a.createElement("div",{style:{backgroundColor:"white",padding:20}},o.a.createElement(re.a,null,t.map(function(n,a){return o.a.createElement("div",{style:$e.box},o.a.createElement(ue.a,{style:$e.button,color:"danger",onClick:function(){return e.deleteHeading(a)}},"X"),o.a.createElement(se.a,{key:a,row:!0},o.a.createElement("div",{style:$e.index},o.a.createElement("h2",null,a+1,".")),o.a.createElement(ce.a,{for:"fi",sm:2},"Otsikko (fi)"),o.a.createElement(oe.a,{sm:10},o.a.createElement(le.a,{type:"text",name:"fi",required:!0,placeholder:"Otsikko suomeksi (pakollinen)",value:n.fi,onChange:function(n){return e.setState({titles:t.map(function(e,t){return a===t?Object(E.a)({},e,{fi:n.target.value}):e})})}})),o.a.createElement(ce.a,{for:"en",sm:2},"Otsikko (en)"),o.a.createElement(oe.a,{sm:10},o.a.createElement(le.a,{type:"text",name:"en",placeholder:"Otsikko englanniksi (ei pakollinen)",value:n.en,onChange:function(n){return e.setState({titles:t.map(function(e,t){return a===t?Object(E.a)({},e,{en:n.target.value}):e})})}}))))}),o.a.createElement(ue.a,{color:"info",block:!0,onClick:function(){return e.setState({titles:Object(Be.a)(t).concat([{fi:"",en:""}])})}},"Lis\xe4\xe4 uusi otsikko"),o.a.createElement(ue.a,{color:"success",size:"lg",block:!0,onClick:function(){return e.createWeek()}},"Luo viikkis!")))}}]),t}(r.Component)),$e={box:{position:"relative",margin:10,backgroundColor:"rgba(0,0,0,0.07)",borderRadius:3,boxShadow:"#999 0 0 7px",border:"1px solid darkgray",padding:"10px 50px 10px 50px"},button:{position:"absolute",top:0,right:0,zIndex:999},index:{position:"absolute",top:2,left:2,zIndex:999}},Xe=X(function(e){function t(){return Object(l.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(u.a)(t,[{key:"socketsOnline",value:function(e){var t=this.props.app.rooms;return(t[e]?t[e].sockets:[]).length>0}},{key:"deleteArticle",value:function(e){window.confirm("Haluatko varmasti poistaa artikkelin?")&&this.props.deleteArticle(e)}},{key:"render",value:function(){var e=this,t=this.props.app.articles.sort(function(e,t){return e.position-t.position});return 0===t.length?o.a.createElement(Je,{year:this.props.year,week:this.props.week}):o.a.createElement(o.a.Fragment,null,o.a.createElement(ue.a,{block:!0,color:"success",onClick:function(){return e.props.navigate("SUMMARY")}},"N\xe4yt\xe4 kooste viikkotiedotteesta"),o.a.createElement(He.a,{flush:!0},t.map(function(t){return o.a.createElement(Pe.a,{key:t.id},o.a.createElement("a",{href:"javascript:void(0)",onClick:function(){return e.props.setConfigState({articleId:t.id,screen:"ARTICLE"})}},t.position,". ",Ae(t.title,t.title_en)),o.a.createElement("br",null),o.a.createElement(ze.a,{color:"success"},t.text.length," merkki\xe4")," "," ",o.a.createElement(ze.a,{color:"warning"},function(e){var t={prefix:"",suffix:" sitten",seconds:"alle minuutti",minute:"noin minuutti",minutes:"%d minuuttia",hour:"noin tunti",hours:"noin %d tuntia",day:"p\xe4iv\xe4",days:"%d p\xe4iv\xe4\xe4",month:"noin kuukausi",months:"%d kuukautta",year:"noin vuosi",years:"%d vuotta"},n=e,a=function(e,n){return t[e]&&t[e].replace(/%d/i,Math.abs(Math.round(n)))};if("0000-00-00 00:00:00"===n)return"Ei muokattu";n=(n=(n=(n=n.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),n=new Date(1e3*n||n);var i=.001*((new Date).getTime()-n)>>0,r=i/60,o=r/60,s=o/24,c=s/365;return"muokattu "+t.prefix+(i<45&&a("seconds",i)||i<90&&a("minute",1)||r<45&&a("minutes",r)||r<90&&a("hour",1)||o<24&&a("hours",o)||o<42&&a("day",1)||s<30&&a("days",s)||s<45&&a("month",1)||s<365&&a("months",s/30)||c<1.5&&a("year",1)||a("years",c))+t.suffix}(t.edited_at))," "," ",e.socketsOnline(t.id)&&o.a.createElement(ze.a,{color:"info"},"joku muokkaamassa"),o.a.createElement(ue.a,{color:"danger",outline:!0,size:"sm",style:{float:"right"},onClick:function(){return e.deleteArticle(t.id)}},"X"))})))}}]),t}(r.Component)),qe=X(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(p.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={failed:!0,loaded:!1},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.init(),this.props.socket.emit("leave room")}},{key:"init",value:function(){var e=Object(g.a)(v.a.mark(function e(){return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.getWeekArticles({year:this.props.config.year,week:this.props.config.week});case 3:this.setState({failed:!1,loaded:!0}),e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),m.toast.error("Ei internet yhteytt\xe4 palvelimeen"),this.setState({failed:!0,loaded:!0});case 10:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.config,n=t.year,a=t.week,i=t.now,r=F()(i).startOf("isoWeek"),s=F()(i).endOf("isoWeek"),c=this.state,l=c.loaded,u=c.failed;return o.a.createElement("div",{style:Ze.wrapper},o.a.createElement("div",{style:Ze.container},o.a.createElement(ue.a,{onClick:function(){return e.props.setPrevWeek()},style:Ze.left,color:"link"},o.a.createElement("h1",null,o.a.createElement("i",{className:"fa fa-angle-left"}))),o.a.createElement("div",{style:Ze.center},o.a.createElement("h1",null,"Viikko ",a),o.a.createElement("h3",null,r.format("DD.MM.YYYY")," - ",s.format("DD.MM.YYYY"))),o.a.createElement(ue.a,{onClick:function(){return e.props.setNextWeek()},style:Ze.right,color:"link"},o.a.createElement("h1",null,o.a.createElement("i",{className:"fa fa-angle-right"})))),l&&!u&&o.a.createElement(Xe,{week:a,year:n}))}}]),t}(r.Component)),Ze={wrapper:{backgroundColor:"white",boxShadow:"#999 0 0 12px",borderRadius:"4px"},container:{flex:1,flexDirection:"row",display:"flex"},left:{flex:.1,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:0},center:{flex:.8,flexDirection:"column",display:"flex",alignItems:"center",justifyContent:"center"},right:{flex:.1,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"}},Qe=n(125),et=n.n(Qe),tt=function(){return o.a.createElement("div",{style:nt.loader},o.a.createElement("div",{style:nt.container},o.a.createElement("h1",{style:nt.text},"Ladataan..."),o.a.createElement(et.a,{type:"Puff",color:"#00BFFF",height:"100",width:"100"})))},nt={loader:{zIndex:1e4,position:"fixed",top:0,left:0,bottom:0,right:0,backgroundColor:"transparent",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:"white"},container:{backgroundColor:"rgba(0,0,0,0.5)",padding:40,display:"flex",justifyContent:"center",alignItems:"center"},text:{color:"white"}},at=function(e){var t=e.navigation;return o.a.createElement("div",null,o.a.createElement(ae,null),o.a.createElement(Fe,null),o.a.createElement(h.a,{style:{marginBottom:20}},t()))},it=function(){return o.a.createElement("div",null,o.a.createElement(ae,null),o.a.createElement(pe,null))},rt=X(function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(p.a)(this,Object(d.a)(t).call(this,e))).props.socket.on("get rooms",function(e){return n.props.setState({rooms:e})}),n.props.socket.on("get sockets",function(e){return n.props.setState({sockets:e})}),n.getText=function(e){return n.props.socket.on("get text",e)},n.onDisconnect=function(e){return n.props.socket.on("disconnect",e)},n}return Object(f.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("email"),t=localStorage.getItem("password");console.log({email:e,password:t}),e&&t&&this.props.login({email:e,password:t}).catch(function(){localStorage.removeItem("email"),localStorage.removeItem("password")})}},{key:"navigation",value:function(){switch(this.props.config.screen){case T:return o.a.createElement(Ke,null);case O:return o.a.createElement(We,{getText:this.getText,onDisconnect:this.onDisconnect});default:return o.a.createElement(qe,null)}}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement(m.ToastContainer,{style:{zIndex:1e5},position:"bottom-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnVisibilityChange:!0,draggable:!0,pauseOnHover:!1}),this.props.app.loading&&o.a.createElement(tt,null),this.props.app.logged?o.a.createElement(at,{navigation:function(){return e.navigation()}}):o.a.createElement(it,null))}}]),t}(r.Component)),ot=n(126),st={loading:!1,articles:[],rooms:{},summary:"",logged:!1,user:{},sockets:[],text:""},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case L.SET_STATE.NAME:return Object(E.a)({},e,n);case L.GET_ARTICLES.PENDING:case L.CREATE_WEEK.PENDING:case L.GET_ARTICLE.PENDING:case L.GET_SUMMARY.PENDING:case L.DELETE_ARTICLE.PENDING:case L.GET_WEEK_ARTICLES.PENDING:case L.LOGIN.PENDING:return Object(E.a)({},e,{loading:!0});case L.GET_ARTICLES.FULFILLED:return Object(E.a)({},e,{loading:!1,articles:n.data});case L.GET_ARTICLES.REJECTED:case L.CREATE_WEEK.REJECTED:case L.DELETE_ARTICLE.REJECTED:case L.GET_ARTICLE.REJECTED:case L.GET_SUMMARY.REJECTED:case L.GET_WEEK_ARTICLES.REJECTED:return m.toast.error("Ei internet yhteytt\xe4 palvelimeen"),Object(E.a)({},e,{loading:!1});case L.LOGIN.REJECTED:return Object(E.a)({},e,{loading:!1});case L.CREATE_WEEK.FULFILLED:return Object(E.a)({},e,{articles:Object(Be.a)(e.articles).concat(Object(Be.a)(n)),loading:!1});case L.GET_ARTICLE.FULFILLED:return Object(E.a)({},e,{articles:e.articles.map(function(e){return e.id===n.id?n:e}),loading:!1});case L.DELETE_ARTICLE.FULFILLED:return Object(E.a)({},e,{articles:e.articles.reduce(function(e,t){return t.id===n.data?e:Object(Be.a)(e).concat([t])},[]),loading:!1});case L.GET_SUMMARY.FULFILLED:return Object(E.a)({},e,{summary:n.data.sort(function(e,t){return e.position-t.position}).reduce(function(e,t){return e+"\n \n"+t.text},""),loading:!1});case L.GET_WEEK_ARTICLES.FULFILLED:return Object(E.a)({},e,{articles:n.data,loading:!1});case L.LOGIN.FULFILLED:return Object(E.a)({},e,{user:n,logged:!0,loading:!1});case L.LOGOUT.NAME:return Object(E.a)({},e,{user:st.user,logged:!1});default:return e}},lt=n(127),ut=n.n(lt),pt={loading:!1,year:parseInt(F()().format("YYYY")),week:parseInt(F()().format("WW")),now:F()().day("Wednesday").year(F()().format("YYYY")).week(F()().format("WW")),screen:null,articleId:null},dt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0,n=t.payload;switch(t.type){case V.SET_CONFIG_STATE.NAME:return Object(E.a)({},e,n);case V.NAVIGATE.NAME:return Object(E.a)({},e,{screen:n});case V.NAVIGATE_HOME.NAME:return pt;default:return e}},ft=ut()("http://viikkis.herokuapp.com"),mt=Object(J.c)({app:ct,config:dt,socket:function(){return ft}}),ht=n(130),Et=n(128),kt=Object(Et.createLogger)({predicate:function(e,t){return!0}}),vt=Object(J.a)(Object(ht.a)(),ot.a,kt),gt=Object(J.d)(mt,vt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(270),n(272),n(274);c.a.render(o.a.createElement($.a,{store:gt},o.a.createElement(rt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[131,2,1]]]);
//# sourceMappingURL=main.e66abcbf.chunk.js.map